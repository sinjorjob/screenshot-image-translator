# 画像翻訳ツール ユーザー利用手順書

## 📋 概要

この画像翻訳ツールは、クリップボードにコピーされた画像内の日本語テキストを自動的に英語に翻訳するWindowsアプリケーションです。

## 🎯 主な機能

- **自動翻訳**: 画像をクリップボードにコピーするだけで自動翻訳開始
- **大画面表示**: 翻訳結果を大きな画面で確認
- **ズーム機能**: Ctrl+マウスホイールで拡大縮小（0.1倍～5倍）
- **自動保存**: 翻訳結果をimagesフォルダに自動保存
- **テスト機能**: 翻訳処理なしで画像表示をテスト可能

---

## 🛠️ 初回セットアップ

### ステップ1: 必要な環境確認
- **OS**: Windows 10/11
- **Python**: 3.12以上
- **OpenAI APIキー**: 事前に取得済みであること
- **⚠️ 重要**: OpenAI組織のID確認（Verified Organization）が完了していること

### ステップ2: OpenAI組織のID確認（重要）

**gpt-image-1 APIを使用するには、組織のID確認が必須です。**

#### A. ID確認状況の確認方法
1. **OpenAI Platform**にアクセス: https://platform.openai.com/
2. **ログイン**して、右上のアカウントメニューをクリック
3. **「Organization settings」**を選択
4. **「Verification」**タブを確認

#### B. ID確認が完了している場合
- **ステータス**: "Verified Organization" と表示
- **この場合**: そのまま次のステップに進んでください

#### C. ID確認が未完了の場合
- **ステータス**: "Unverified" または "Pending" と表示
- **必要な手続き**:

##### C-1. 個人ユーザーの場合
1. **「Settings」→「Billing」**に移動
2. **「Payment methods」**でクレジットカードを登録
3. **最低$5の課金**を実行（プリペイド形式）
4. **電話番号認証**を完了
5. **24-48時間後**に自動的に確認完了

##### C-2. 企業ユーザーの場合
1. **「Organization settings」→「Verification」**に移動
2. **「Submit verification request」**をクリック
3. **必要書類をアップロード**:
   - 法人登記簿謄本（英語版）
   - 事業証明書
   - 担当者の身分証明書
4. **審査期間**: 3-7営業日
5. **確認完了後にメール通知**を受信

##### C-3. 確認完了の待機期間中
- **APIアクセス**: gpt-image-1は使用不可
- **代替案**: 通常のGPT-4 Vision API（OCR + テキスト翻訳）の使用を検討
- **このツール**: ID確認完了後に使用開始してください

#### D. 確認完了の最終チェック
1. **Platform画面**で "Verified Organization" を確認
2. **API Keys**ページでgpt-image-1へのアクセス権限を確認
3. **Billing**ページで課金設定が有効であることを確認

**⚠️ 注意**: ID確認が未完了の状態でツールを実行すると、API呼び出しエラーが発生します。

### ステップ3: ファイルのダウンロード
プロジェクトファイルを適当なフォルダに配置してください。

```
C:\ImageTranslator\  (例)
├── README.md              # プロジェクト概要
├── requirements.txt       # Python依存パッケージ
├── .env                   # 環境変数（後で作成）
├── .env.example          # 環境変数テンプレート
├── config/               # 設定ファイル
│   └── config.json      # アプリケーション設定
├── source/              # ソースコード
│   ├── main.py         # メインプログラム
│   └── assets/         # 静的リソース
│       └── icons/      # アプリアイコン
│           ├── ON.png  # 自動翻訳ON時
│           └── OFF.png # 自動翻訳OFF時
├── images/              # 翻訳結果画像（自動生成）
├── logs/                # ログファイル（自動生成）
└── docs/               # ドキュメント
```

### ステップ4: Pythonパッケージのインストール
1. **コマンドプロンプトまたはPowerShellを開く**
2. **プロジェクトフォルダ（ルート）に移動**
   ```cmd
   cd C:\ImageTranslator
   ```
3. **必要なパッケージをインストール**
   ```cmd
   pip install -r requirements.txt
   ```

### ステップ5: APIキーの設定
1. **プロジェクトルートに`.env`ファイルを作成**（`.env.example`をコピー）
2. **メモ帳で`.env`ファイルを開く**
3. **以下の内容を記述してAPIキーを設定**
   ```
   OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   ```
   ※ `sk-xxxxx` の部分を実際のAPIキーに置き換えてください

### ステップ6: 設定の確認・調整（オプション）
`config/config.json`ファイルで以下の設定を調整できます：

- **翻訳品質**: `"quality": "medium"` または `"high"`
- **超精密モード**: `"ultra_precision_mode": true/false`
- **画像表示サイズ**: `"max_display_width"`, `"max_display_height"`

詳細は `config_guide.md` を参照してください。

---

## 🚀 アプリケーションの起動

### ステップ1: アプリケーションの実行
1. **コマンドプロンプトまたはPowerShellでsourceフォルダに移動**
   ```cmd
   cd C:\ImageTranslator\source
   ```
2. **アプリケーションを起動**
   ```cmd
   python main.py
   ```

### ステップ2: 起動確認
- **システムトレイ（画面右下）にグレーのアイコンが表示される**（OFF状態）
- **「起動しました。自動翻訳はOFFです。」という通知が表示される**

---

## 📸 基本的な使用方法

### 翻訳の実行手順

#### ステップ1: 自動翻訳をONにする
1. **システムトレイのグレーアイコンを右クリック**
2. **「🔴 自動翻訳: OFF」をクリック**
3. **アイコンが緑色に変わり「🟢 自動翻訳: ON」に変更される**
4. **通知「自動翻訳が有効になりました」が表示される**

#### ステップ2: 画像のキャプチャ
1. **Windowsの標準スクリーンショット機能を使用**
   - **キーボード**: `Win + Shift + S`
   - **または**: スタートメニュー → 「切り取り領域とスケッチ」
2. **翻訳したい日本語テキストが含まれる部分を選択**
3. **範囲選択が完了すると自動的にクリップボードにコピーされる**

#### ステップ3: 自動翻訳開始
- **画像がクリップボードにコピーされると自動的に翻訳処理が開始**
- **システムトレイに「翻訳処理を開始しました...」と通知表示**
- **処理時間**: 通常10～30秒程度

#### ステップ4: 結果確認
1. **翻訳完了後、大画面で結果が自動表示される**
2. **画像の拡大縮小**: `Ctrl + マウスホイール`
3. **画像の移動**: 拡大時はマウスドラッグまたはスクロールバー
4. **現在のズーム倍率**: 画面下部に表示

#### ステップ5: 結果の保存・終了
- **自動保存**: `images`フォルダに自動的に保存済み
- **画面を閉じる**: 「閉じる」ボタンをクリック

---

## 🧪 テスト機能の使用方法

翻訳処理を実行せずに画像表示機能をテストできます。

### ステップ1: テスト機能の起動
1. **システムトレイのアイコンを右クリック**
2. **「📸 画像表示テスト」を選択**

### ステップ2: 画像ファイルの選択
1. **ファイル選択ダイアログが開く**
2. **imagesフォルダまたは任意のフォルダから画像を選択**
3. **「開く」をクリック**

### ステップ3: 表示テスト
- **選択した画像が大画面で表示される**
- **ズーム機能やUI要素のテストが可能**

---

## ⚙️ 設定とカスタマイズ

### 翻訳品質の設定
`config.json`の`"quality"`を変更：
- **`"medium"`**: $0.04/枚（推奨・一般用途）
- **`"high"`**: $0.17/枚（最高品質・プロ用途）

### 超精密モード
`config.json`の`"ultra_precision_mode"`を`true`に設定：
- **アイコンやデザインの変更を防ぐ**
- **自動的にhigh品質を使用**
- **コスト**: $0.17/枚

### 画像表示サイズ
`config.json`の表示サイズを調整：
```json
"max_display_width": 1400,
"max_display_height": 1000
```

詳細な設定については `config_guide.md` を参照してください。

---

## 📁 ファイル・フォルダ構成

### 自動生成されるフォルダ
- **`images/`**: 翻訳結果の画像が保存される
- **`logs/`**: アプリケーションのログファイルが保存される

### 保存される画像
- **元画像**: `元画像_YYYYMMDD_HHMMSS.png`
- **翻訳後画像**: `translated_YYYYMMDD_HHMMSS.png`

---

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 1. アプリケーションが起動しない
**原因**: 必要なパッケージがインストールされていない
**解決方法**:
```cmd
pip install -r requirements.txt
```

#### 2. 「APIキーが設定されていません」エラー
**原因**: `.env`ファイルが正しく設定されていない
**解決方法**:
- `.env`ファイルの存在確認
- APIキーの形式確認（`sk-`で始まる）
- ファイルの保存場所確認（`source`フォルダ内）

#### 3. 翻訳が実行されない
**原因**: クリップボードに画像がコピーされていない
**解決方法**:
- `Win + Shift + S`で画面キャプチャを再実行
- システムトレイにアプリが常駐しているか確認

#### 4. 「qt.qpa.plugin」エラー
**原因**: PyQt5のプラグインパスの問題
**解決方法**: アプリケーションを再起動

#### 5. 「gpt-image-1モデルへのアクセスが拒否されました」エラー
**原因**: OpenAI組織のID確認（Verified Organization）が未完了
**解決方法**:
- OpenAI Platformで組織の確認状況を確認
- 個人ユーザー: $5の課金と電話番号認証を完了
- 企業ユーザー: 法人書類をアップロードして審査完了を待つ
- 確認完了まで待機（個人: 24-48時間、企業: 3-7営業日）

#### 6. 「Insufficient quota」または「Rate limit exceeded」エラー
**原因**: API使用制限またはクレジット不足
**解決方法**:
- OpenAI Platformの「Billing」でクレジット残高を確認
- 追加のクレジットを購入
- 使用制限を確認し、必要に応じてアップグレード

#### 7. 翻訳結果に余白が表示される
**原因**: アスペクト比の調整
**解決方法**: 現在のバージョンでは自動的にパディング除去を実行

### ログファイルの確認
問題が解決しない場合は、`log`フォルダ内のログファイルを確認してください：
```
log\image_translator_YYYYMMDD_HHMMSS.log
```

---

## ❌ アプリケーションの終了

### 通常の終了方法
1. **システムトレイの青いアイコンを右クリック**
2. **「終了」を選択**

### 強制終了（異常時）
1. **タスクマネージャー**を開く（`Ctrl + Shift + Esc`）
2. **「python.exe」または「main.py」を探す**
3. **「タスクの終了」をクリック**

---

## ⚠️ 重要な注意事項

### OpenAI gpt-image-1 API の制限事項
- **組織確認必須**: Verified Organization ステータスが必要
- **課金設定必須**: 有効なクレジットカードとプリペイドクレジット
- **企業利用**: 法人書類による審査が必要（3-7営業日）
- **個人利用**: 最低$5の課金と電話番号認証が必要

### 使用開始前のチェックリスト
- [ ] OpenAI Platform で "Verified Organization" の確認
- [ ] API キーの有効性確認
- [ ] クレジット残高の確認（最低$10を推奨）
- [ ] 課金設定の有効化確認

---

## 💰 使用料金について

### 料金体系（OpenAI APIの料金）
- **Medium品質**: $0.04/枚
- **High品質**: $0.17/枚
- **超精密モード**: 自動的にHigh品質（$0.17/枚）

### 節約のコツ
- **必要な時だけ使用**: 不要な画像キャプチャを避ける
- **品質設定**: 一般用途にはMedium品質を推奨
- **テスト機能**: 画面表示テストは無料

---

### 関連ドキュメント
- **設定ガイド**: `config_guide.md`
- **機能要件**: `functional_requirements.md`
- **詳細設計**: `detailed_design.md`

---

*作成日: 2025年1月16日*
*バージョン: 1.0*
*対応アプリケーションバージョン: 1.0*